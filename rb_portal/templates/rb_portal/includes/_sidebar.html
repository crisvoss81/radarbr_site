{% comment %} Sidebar otimizada para AdSense {% endcomment %}
{% load adsense_extras %}

<!-- AdSense Banner Top -->
<div class="ad-slot ad-slot--top">
  {% adsense_banner "9538493649" 300 250 %}
  <!-- Substitua o nÃºmero acima pelo seu ad-slot real -->
</div>

<!-- Trending News Card (Compacto) -->
<section class="sidebar-card trending-card" aria-labelledby="trending-title">
  <header class="card-header">
    <h3 id="trending-title" class="card-title">
      <svg class="card-icon" viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
        <path d="M13 7.83l1.88 1.88-1.6 1.6 1.41 1.41L17 9.42c.39-.39.39-1.02 0-1.41L14.7 5.7l-1.41 1.41L13 7.83zM5 3h14c1.1 0 2 .9 2 2v14c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2zm0 2v14h14V5H5zm4.41 7.41L10 13.17l-.59-.59L8 13.17l1.41 1.41L10 15l2-2-1.41-1.41L10 12.17z"/>
      </svg>
      Em alta
    </h3>
  </header>
  
  <div class="card-content">
    {% with hot=trending|default:others|default:page_obj.object_list %}
      {% for obj in hot|slice:':4' %}
        <article class="trending-item">
          <a href="{{ obj.get_absolute_url }}" class="trending-link">
            <div class="trending-image">
              {% if obj.imagem %}
                <img 
                  src="{{ obj.imagem }}" 
                  width="60" height="40"
                  loading="lazy" decoding="async"
                  alt="{{ obj.imagem_alt|default:obj.titulo|striptags }}"
                  class="trending-img"
                >
              {% else %}
                <div class="trending-ph trending-ph--{{ obj.categoria.slug|default:'geral' }}">
                  <div class="trending-ph-icon">ðŸ“°</div>
                </div>
              {% endif %}
            </div>
            <div class="trending-content">
              <h4 class="trending-title">{{ obj.titulo|striptags|truncatechars:50 }}</h4>
              <div class="trending-meta">
                <time datetime="{{ obj.publicado_em|date:'c' }}" class="trending-time">
                  {{ obj.publicado_em|timesince }} atrÃ¡s
                </time>
              </div>
            </div>
          </a>
        </article>
      {% empty %}
        <p class="empty-state">Sem notÃ­cias em destaque.</p>
      {% endfor %}
    {% endwith %}
  </div>
</section>

<!-- AdSense Banner Middle -->
<div class="ad-slot ad-slot--middle">
  {% adsense_banner "4286166963" 300 250 %}
  <!-- Substitua o nÃºmero acima pelo seu ad-slot real -->
</div>

<!-- Categories Card (Compacto) -->
<section class="sidebar-card categories-card" aria-labelledby="categories-title">
  <header class="card-header">
    <h3 id="categories-title" class="card-title">
      <svg class="card-icon" viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
      </svg>
      Categorias
    </h3>
  </header>
  
  <div class="card-content">
    <nav class="categories-nav" role="navigation" aria-label="NavegaÃ§Ã£o por categorias">
      {% for cat in cats|slice:':8' %}
        <a href="{{ cat.get_absolute_url }}" class="category-link" 
           aria-label="Ver notÃ­cias da categoria {{ cat.nome }}">
          <span class="category-name">{{ cat.nome }}</span>
        </a>
      {% empty %}
        <p class="empty-state">Sem categorias cadastradas.</p>
      {% endfor %}
      
      {% if cats|length > 8 %}
        <a href="/categorias/" class="category-link category-link--more">
          <span class="category-name">Ver todas</span>
          <svg class="category-arrow" viewBox="0 0 24 24" width="14" height="14" fill="currentColor">
            <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
          </svg>
        </a>
      {% endif %}
    </nav>
  </div>
</section>

<!-- AdSense Banner Bottom -->
<div class="ad-slot ad-slot--bottom">
  {% adsense_banner "3631506847" 300 600 %}
  <!-- Substitua o nÃºmero acima pelo seu ad-slot real -->
</div>

<!-- JSON-LD para SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "RadarBR",
  "url": "{{ SITE_BASE_URL }}",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "{{ SITE_BASE_URL }}/busca/?q={search_term_string}",
    "query-input": "required name=search_term_string"
  },
  "mainEntity": {
    "@type": "ItemList",
    "itemListElement": [
      {% for cat in cats %}
      {
        "@type": "ListItem",
        "position": {{ forloop.counter }},
        "name": "{{ cat.nome|escapejs }}",
        "url": "{{ SITE_BASE_URL }}{{ cat.get_absolute_url }}"
      }{% if not forloop.last %},{% endif %}
      {% endfor %}
    ]
  }
}
</script>